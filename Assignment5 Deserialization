package com.company;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.io.Serializable;

class Address implements Serializable
{

    private String city;
    private String state;
    private String country;
    private int pinCode;

    public Address(String city, String state, String country, int pinCode) {
        this.city = city;
        this.state = state;
        this.country = country;
        this.pinCode = pinCode;
    }

    public String getCity() {
        return city;
    }

    public String getState() {
        return state;
    }

    public String getCountry() {
        return country;
    }

    public int getPinCode() {
        return pinCode;
    }
}


class Student implements Serializable
{
    private String name;
    private String dateOfBirth;
    private Address address;

    public Student(String name, String dateOfBirth, Address address) {
        this.name = name;
        this.dateOfBirth = dateOfBirth;
        this.address = address;
    }

    public String getName() {
        return name;
    }

    public String getDateOfBirth() {
        return dateOfBirth;
    }

    public Address getAddress() {
        return address;
    }
}


class DeserializationTest
{
    private String FILE_NAME;

    public DeserializationTest(String FILE_NAME) {
        this.FILE_NAME = FILE_NAME;
    }


    public void readFromFileAndPrint() throws IOException
    {
        FileInputStream fis = new FileInputStream(FILE_NAME);
        boolean cont = true;

            try (ObjectInputStream input = new ObjectInputStream(fis)) {
                while (cont) {
                    Student obj = (Student) input.readObject();
                    if (obj != null) {
                        System.out.println("Name: " + obj.getName());
                        System.out.println("Date of Birth: " + obj.getDateOfBirth());
                        Address address = obj.getAddress();
                        System.out.println("City: " + address.getCity());
                        System.out.println("State: " + address.getState());
                        System.out.println("Country: " + address.getCountry());
                        System.out.println("Pin code: " + address.getPinCode());
                    } else {
                        cont = false;
                    }
                }
            } catch (Exception e) {
                // System.out.println(e.printStackTrace());
            }
    }
}
public class Main {

    public static void main(String[] args) {

        if(args.length<1)
        {
            System.out.println("Please Provide File name");
            return;
        }
        String fileName=args[0];
        DeserializationTest d = new DeserializationTest(fileName);
        try
        {
            d.readFromFileAndPrint();
            System.out.println("Deserialization Done");
        }catch (IOException io)
        {
            System.out.println(io);
        }
    }
}
